<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:sec="http://www.springframework.org/security/facelets/tags">

<ui:composition template="/WEB-INF/templates/formLayout.xhtml">

    <ui:define name="titleForm">
        #{bundle['_nls.tabela_preco.titulo']}
    </ui:define>

    <ui:define name="bodyForm">
        <a4j:keepAlive beanName="itemTabelaPrecoBean"/>
        <a4j:keepAlive beanName="tabelaPrecoBean"/>
        <a4j:keepAlive beanName="anexoTabelaPrecoBean"/>
        <a4j:keepAlive beanName="msaBean"/>
        <a4j:loadScript src="/js/utils.js"/>
        <a4j:loadScript src="/js/jquery.numeric.js"/>
        <a4j:loadScript src="/js/jquery.meio.mask.js"/>
        <rich:spacer height="0" width="560" styleClass="noMargin"/>

        <!-- Detalhes da price table -->
        <h:panelGrid columns="5" id="detailsPriceTable">

            <h:outputText value="#{bundle['_nls.msa.entity_name']}: "
                          styleClass="labelGeneric"/>
            <h:outputText value="#{msaController.bean.to.nomeMsa}"/>

            <rich:spacer width="20px"/>

            <h:outputText value="#{bundle['_nls.msa.cliente_msa.label']}: "
                          styleClass="labelGeneric"/>
            <h:outputText value="#{msaController.bean.to.cliente.nomeCliente}"/>

            <h:outputText
                    value="#{bundle['_nls.item_tabela_preco.tabela_preco.label']}:"
                    styleClass="labelGeneric"/>
            <h:outputText
                    value="#{msaController.tabelaPrecoBean.to.descricaoTabelaPreco}"/>

            <rich:spacer width="20px"/>

            <h:outputText value="#{bundle['_nls.deal.moeda.label']}:"
                          styleClass="labelGeneric"/>
            <h:outputText
                    value="#{msaController.tabelaPrecoBean.to.moeda.nomeMoeda}"/>

            <h:outputText
                    value="#{bundle['_nls.cpcl.data_inicio_vigencia.label']}:"
                    styleClass="labelGeneric"/>
            <h:outputText
                    value="#{msaController.tabelaPrecoBean.to.dataInicioVigencia}">
                <f:convertDateTime pattern="MMM/yyyy"/>
            </h:outputText>

            <rich:spacer width="20px"/>

            <h:outputText value="#{bundle['_nls.cpcl.data_fim_vigencia.label']}:"
                          styleClass="labelGeneric"/>

            <h:outputText
                    value="#{msaController.tabelaPrecoBean.to.dataFimVigencia}">
                <f:convertDateTime pattern="MMM/yyyy"/>
            </h:outputText>

            <h:outputText value="#{bundle['_nls.tabela_preco.status.label']}
: "
                          styleClass="labelGeneric"/>
            <h:outputText value="#{msaController.tabelaPrecoBean.to.priceTableStatusFlowPms.name}"/>
        </h:panelGrid>


        <rich:spacer height="08"/>

        <h:form>
            <h:panelGrid columns="2">
                <a4j:commandButton action="#{msaController.backToPriceTable}"
                                   value="#{bundle['_nls.button.back']}" styleClass="buttonGeneric"/>
                <sec:ifAnyGranted roles="BUS.MSA:ED,BUS.MSA:CR">
                    <a4j:commandButton
                            value="#{bundle['_nls.anexo.tabela_preco.attach']}"
                            oncomplete="#{rich:component('addArquivoModal')}.show()"
                            action="#{msaController.prepareAddAnexo}"
                            rendered="#{msaController.msaContratoBean.isPriceTableEditorLogin}"
                            ajaxSingle="true"/>
                </sec:ifAnyGranted>
            </h:panelGrid>

            <rich:spacer height="5"/>

            <!-- Lista de arquivos -->
            <rich:dataTable width="100%"
                            value="#{msaController.anexoTabelaPrecoBean.listaAnexoTabelaPreco}"
                            var="item" id="listaAnexo">

                <rich:column sortBy="#{item.textoNomeArquivo}">
                    <f:facet name="header">
                        <h:outputText
                                value="#{bundle['_nls.anexo.tabela_preco.file_name']}"/>
                    </f:facet>
                    <h:outputText value="#{item.textoNomeArquivo}" id="nomeArquivo"/>

                    <rich:toolTip for="nomeArquivo"
                                  value="Upload Date: #{item.dataUpload}"/>
                </rich:column>

                <rich:column style="text-align: center;" sortBy="#{item.textoAutor}">
                    <f:facet name="header">
                        <h:outputText value="#{bundle['_nls.anexo.tabela_preco.autor']}"/>
                    </f:facet>
                    <h:outputText value="#{item.textoAutor}"/>
                </rich:column>

                <rich:column style="text-align: center;">
                    <f:facet name="header">
                        <h:outputText
                                value="#{bundle['_nls.anexo.tabela_preco.comentario']}"/>
                    </f:facet>
                    <h:outputText value="#{item.textoComentario}"/>
                </rich:column>

                <rich:column style="text-align: center;">
                    <f:facet name="header">
                        <h:outputText
                                value="#{bundle['_nls.item_tabela_preco.action.label']}"/>
                    </f:facet>
                    <!-- Botao download do anexo -->
                    <h:commandLink id="downloadLink"
                                   action="#{msaController.downloadAnexo}">

                        <h:graphicImage value="/images/download.png" style="border:0"/>
                        <f:setPropertyActionListener value="#{item}"
                                                     target="#{msaController.anexoTabelaPrecoBean.to}"/>

                    </h:commandLink>
                    <rich:toolTip for="downloadLink"
                                  value="#{bundle['_nls.anexo.tabela_preco.download']}"/>

                    <!-- Botao delete do anexo -->
                    <a4j:commandLink ajaxSingle="true" id="deleteAnexoLink"
                                     oncomplete="#{rich:component('deleteAnexoModalPanel')}.show()">

                        <h:graphicImage value="/images/icons/delete.gif" style="border:0"/>
                        <f:setPropertyActionListener value="#{item}"
                                                     target="#{msaController.anexoTabelaPrecoBean.to}"/>

                    </a4j:commandLink>
                    <rich:toolTip for="deleteAnexoLink"
                                  value="#{bundle['_nls.hint.delete']}"/>
                </rich:column>

                <f:facet name="footer">
                    <h:outputText value="No Files"
                                  rendered="#{empty msaController.anexoTabelaPrecoBean.listaAnexoTabelaPreco}"
                                  style="font-style: italic;"/>
                </f:facet>
            </rich:dataTable>
        </h:form>


        <rich:spacer height="10"/>

        <rich:panel header="#{bundle['_nls.tabela_preco.titulo']}">

            <h:form>
                <!-- Add item -->
                <h:panelGrid columns="2">

                    <sec:ifAnyGranted roles="BUS.MSA:ED,BUS.MSA:CR">
                        <a4j:commandButton ajaxSingle="true" id="addItemTabelaPreco"
                                           oncomplete="#{rich:component('addItemTabelaPrecoModal')}.show()"
                                           value="#{bundle['_nls.item_tabela_preco.new']}"
                                           action="#{msaController.prepareAddItemTabelaPreco}"
                                           reRender="addItemTabelaPrecoModal"
                                           rendered="#{msaController.msaContratoBean.isPriceTableEditorLogin or msaContratoBean.isPriceTableApproverLogin}"
                                           styleClass="buttonGeneric"
                                           disabled="#{msaController.tabelaPrecoBean.to.isAddItemPriceTableButton}">
                        </a4j:commandButton>

                    </sec:ifAnyGranted>
                </h:panelGrid>
                <rich:spacer height="5" styleClass="noMargin"/>

                <!-- Lista de itens -->
                <rich:dataTable width="100%"
                                value="#{msaController.itemTabelaPrecoBean.listaItemTabelaPrecoRow}"
                                var="item" id="lista">


                    <f:facet name="header">
                        <rich:columnGroup style="background-color: #{item.backgroundColor}">
                                <rich:column style="background-color: #{item.backgroundColor}">
                                    <h:outputText rendered="true"
                                                  value="#{bundle['_nls.select.label']}"
                                                  styleClass="labelGeneric" />
                                    <rich:spacer height="5" width="5" />
                                    <h:outputLabel rendered="true"
                                                   value="#{bundle['_nls.all.label']}" styleClass="linkGeneric"
                                                   onclick="javascript: checkAllCheckbox();" />
                                    <rich:spacer height="5" width="5" />
                                    <h:outputText value="/" rendered="true" styleClass="labelGeneric" />
                                    <rich:spacer height="5" width="5" />
                                    <h:outputLabel rendered="true"
                                                   value="#{bundle['_nls.none.label']}" styleClass="linkGeneric"
                                                   onclick="javascript: uncheckAllCheckbox();" />
                                </rich:column>
                                <rich:column colspan="9" style="background-color: #{item.backgroundColor}"></rich:column>
                        </rich:columnGroup>
                    </f:facet>

                    <rich:column style="text-align: center; background-color: #{item.backgroundColor}">
                        <f:facet name="header">
                            <h:outputText
                                    value="#{bundle['_nls.item_tabela_preco.approve']}"/>
                        </f:facet>
                        <h:selectBooleanCheckbox value="#{item.approved}"
                                                 disabled="#{msaController.itemTabelaPrecoBean.to.tabelaPreco.isApprovedCheckboxEdit}"/>
                    </rich:column>

                    <!-- Perfil Vendido -->
                    <rich:column style="text-align: center; background-color: #{item.backgroundColor}"
                                 sortBy="#{item.itemTabelaPreco.perfilVendido.nomePerfilVendido}">
                        <f:facet name="header">
                            <h:outputText
                                    value="#{bundle['_nls.perfil_vendido.entity_name']}"/>
                        </f:facet>
                        <h:outputText
                                value="#{item.itemTabelaPreco.perfilVendido.nomePerfilVendido}"/>
                    </rich:column>

                    <!-- Cargo -->
                    <rich:column style="background-color: #{item.backgroundColor}"
                            sortBy="#{item.itemTabelaPreco.perfilVendido.perfilPadrao.cargoPms.nomeCargoPms}">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.perfil_vendido.position']}"/>
                        </f:facet>
                        <h:outputText
                                value="#{item.itemTabelaPreco.perfilVendido.perfilPadrao.cargoPms.nomeCargoPms}"/>
                    </rich:column>

                    <!-- PMG -->
                    <rich:column style=" background-color: #{item.backgroundColor}"
                            sortBy="#{item.itemTabelaPreco.perfilVendido.perfilPadrao.pmg.nomePmg}">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.perfil_vendido.PMG']}"/>
                        </f:facet>
                        <h:outputText
                                value="#{item.itemTabelaPreco.perfilVendido.perfilPadrao.pmg.nomePmg}"/>
                    </rich:column>

                    <!-- Cidade Base -->
                    <rich:column style=" background-color: #{item.backgroundColor}"
                            sortBy="#{item.itemTabelaPreco.perfilVendido.perfilPadrao.cidadeBase.siglaCidadeBase}">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.perfil_vendido.base']}"/>
                        </f:facet>
                        <h:outputText
                                value="#{item.itemTabelaPreco.perfilVendido.perfilPadrao.cidadeBase.siglaCidadeBase}"/>
                    </rich:column>

                    <!-- Valor por Hora -->
                    <rich:column style=" background-color: #{item.backgroundColor}" sortBy="#{item.itemTabelaPreco.valorItemTbPreco}">
                        <f:facet name="header">
                            <h:outputText
                                    value="#{bundle['_nls.tabela_preco.item.rate_hour']}"/>
                        </f:facet>

                        <h:outputText
                                value="#{item.itemTabelaPreco.perfilVendido.moeda.siglaMoeda}"/>

                        <rich:spacer width="2px"/>
                        <sec:ifAnyGranted roles="BUS.MSA:ED,BUS.MSA:CR">
                            <h:inputText value="#{item.itemTabelaPreco.valorItemTbPreco}"
                                         id="valor" style="width: 60px"
                                         rendered="#{msaController.msaContratoBean.isPriceTableEditorLogin or msaContratoBean.isPriceTableApproverLogin}"
                                         disabled="#{tabelaPrecoBean.to.isItemPriceTableField}">
                                <rich:jQuery selector="#valor"
                                             query="setMask('#{bundle['jquery.monetary.pattern']}')"
                                             timing="onload"/>
                                <f:convertNumber locale="#{bundle['locale.en_us']}"
                                                 pattern="#{systemProperties['pattern.number']}"/>
                            </h:inputText>
                            <h:outputText
                                    value="#{item.itemTabelaPreco.valorItemTbPreco}"
                                    rendered="#{!msaController.msaContratoBean.isPriceTableEditorLogin or msaContratoBean.isPriceTableApproverLogin}"
                                    disabled="#{tabelaPrecoBean.to.isItemPriceTableField}">
                                <f:convertNumber locale="#{bundle['locale.en_us']}"
                                                 pattern="#{systemProperties['pattern.number']}"/>
                            </h:outputText>
                        </sec:ifAnyGranted>
                        <sec:ifNotGranted roles="BUS.MSA:ED,BUS.MSA:CR">
                            <h:outputText
                                    value="#{item.itemTabelaPreco.valorItemTbPreco}">
                                <f:convertNumber locale="#{bundle['locale.en_us']}"
                                                 pattern="#{systemProperties['pattern.number']}"/>
                            </h:outputText>
                        </sec:ifNotGranted>
                    </rich:column>

                    <!-- Valor em FTEs -->
                    <rich:column style=" background-color: #{item.backgroundColor}" sortBy="#{item.fte}">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['nls.tabela_preco.item.rate_FTE']}"/>
                        </f:facet>

                        <h:outputText
                                value="#{item.itemTabelaPreco.perfilVendido.moeda.siglaMoeda}"/>

                        <rich:spacer width="2px"/>
                        <sec:ifAnyGranted roles="BUS.MSA:ED,BUS.MSA:CR">
                            <h:inputText value="#{item.fte}" id="valorFte" style="width: 60px"
                                         rendered="#{msaController.msaContratoBean.isPriceTableEditorLogin or msaContratoBean.isPriceTableApproverLogin}"
                                         disabled="#{tabelaPrecoBean.to.isItemPriceTableField}">
                                <rich:jQuery selector="#valorFte"
                                             query="setMask('#{bundle['jquery.monetary.pattern']}')"
                                             timing="onload"/>
                                <f:convertNumber locale="#{bundle['locale.en_us']}"
                                                 pattern="#{systemProperties['pattern.number']}"/>
                            </h:inputText>
                            <h:outputText value="#{item.fte}"
                                          rendered="#{!msaController.msaContratoBean.isPriceTableEditorLogin}"/>
                        </sec:ifAnyGranted>
                        <sec:ifNotGranted roles="BUS.MSA:ED,BUS.MSA:CR">
                            <h:outputText
                                    value="#{item.fte}"/>
                        </sec:ifNotGranted>
                    </rich:column>

                    <!-- Percentual Embutido -->
                    <rich:column style=" background-color: #{item.backgroundColor}">
                        <f:facet name="header">
                            <h:panelGroup style="display: flex; align-items: center;">
                                <h:outputText value="#{bundle['_nls.item_tabela_preco.embedded_cost_abreviacao']}"/>
                                <rich:toolTip for="embeddedCostInfo">#{bundle['_nls.item_tabela_preco.embedded_cost.tooltip']}</rich:toolTip>
                                <h:graphicImage id="embeddedCostInfo" value="/images/icons/info.gif" style="border:0;padding:5px;" />
                            </h:panelGroup>
                        </f:facet>
                        <sec:ifAnyGranted roles="BUS.MSA:ED,BUS.MSA:CR">
                            <h:inputText value="#{item.itemTabelaPreco.percentualDespesa}"
                                         id="percDespesa" style="width: 60px; text-align: right;"
                                         rendered="#{msaController.msaContratoBean.isPriceTableEditorLogin or msaContratoBean.isPriceTableApproverLogin}"
                                         disabled="#{tabelaPrecoBean.to.isItemPriceTableField}">
                                <f:validateDoubleRange maximum="100" />
                                <f:convertNumber locale="#{bundle['locale.en_us']}"
                                                 pattern="#{systemProperties['pattern.number']}"/>
                            </h:inputText>
                            <h:outputText
                                    value="#{item.itemTabelaPreco.percentualDespesa}"
                                    rendered="#{!msaController.msaContratoBean.isPriceTableEditorLogin}"/>
                        </sec:ifAnyGranted>
                        <sec:ifNotGranted roles="BUS.MSA:ED,BUS.MSA:CR">
                            <h:outputText
                                    value="#{item.itemTabelaPreco.percentualDespesa}"/>
                        </sec:ifNotGranted>
                        <h:outputLabel value="%"/>
                    </rich:column>

                    <!-- Valor Embutido -->
                    <rich:column sortBy="#{item.itemTabelaPreco.valorDespesa}"
                                 style="text-align: right; background-color: #{item.backgroundColor}">
                        <f:facet name="header">
                            <h:outputText
                                    value="#{bundle['_nls.item_tabela_preco.embedded_cost_abreviacao_fte']}"/>
                        </f:facet>

                        <h:outputText
                                value="#{item.itemTabelaPreco.perfilVendido.moeda.siglaMoeda}"/>

                        <rich:spacer width="2px"/>

                        <h:outputText value="#{item.itemTabelaPreco.valorDespesa}"
                                      style="width: 60px" id="vlrDespesa">
                            <f:convertNumber locale="#{bundle['locale.en_us']}"
                                             pattern="#{systemProperties['pattern.number']}"/>
                        </h:outputText>
                    </rich:column>

                    <!-- Actions -->
                    <rich:column style="text-align: center; background-color: #{item.backgroundColor}"
                                 rendered="#{msaController.msaContratoBean.isPriceTableEditorLogin}">
                        <f:facet name="header">
                            <h:outputText
                                    value="#{bundle['_nls.item_tabela_preco.action.label']}"/>
                        </f:facet>

                        <!-- Botao delete do perfil vendido -->
                        <sec:ifAnyGranted roles="BUS.MSA:ED,BUS.MSA:CR">
                            <a4j:commandLink ajaxSingle="true" id="deleteLink"
                                             oncomplete="#{rich:component('deleteItemTabelaPrecoPanel')}.show()"
                                             rendered="#{msaController.msaContratoBean.isPriceTableEditorLogin or msaContratoBean.isPriceTableApproverLogin}"
                                             disabled="#{tabelaPrecoBean.to.isItemPriceTableField}">

                                <h:graphicImage value="/images/icons/delete.gif" style="border:0"/>
                                <f:setPropertyActionListener value="#{item.itemTabelaPreco}"
                                                             target="#{msaController.itemTabelaPrecoBean.to}"/>

                            </a4j:commandLink>
                            <rich:toolTip for="deleteLink"
                                          value="#{bundle['_nls.hint.delete']}"/>
                        </sec:ifAnyGranted>
                    </rich:column>

                </rich:dataTable>


                <h:outputText value="#{bundle['_nls.tabela_preco.status.label']}*:"
                              for="priceTableStatusName" styleClass="labelGeneric" />
                <rich:comboBox id="priceTableStatusName"
                               label="#{bundle['_nls.tabela_preco.status.label']}"
                               value="#{msaController.tabelaPrecoBean.priceTableStatusSelect.selected}"
                               valueChangeListener="#{msaController.priceTableStatusSelectListener}"
                               suggestionValues="#{msaController.tabelaPrecoBean.priceTableStatusSelect.list}"
                               required="true" directInputSuggestions="true"
                               disabled="#{tabelaPrecoBean.to.isItemPriceTableControl}">
                    <a4j:support event="onselect" limitToList="true"></a4j:support>
                </rich:comboBox>


                <rich:spacer height="20"/>
                <sec:ifAnyGranted roles="BUS.MSA:ED,BUS.MSA:CR">
                    <a4j:commandButton value="#{bundle['_nls.button.save']}"
                                       reRender="notApproveReasonsPanel, lista, detailsPriceTable"
                                       rendered="#{msaController.msaContratoBean.isPriceTableEditorLogin or msaContratoBean.isPriceTableApproverLogin}"
                                       action="#{msaController.updateListItemTabPrecoRow}"
                                       styleClass="buttonGeneric"
                                       disabled="#{tabelaPrecoBean.to.isItemPriceTableControl} "/>
                </sec:ifAnyGranted>

            </h:form>
        </rich:panel>


        <!-- Modal Add item -->
        <rich:modalPanel id="addItemTabelaPrecoModal" autosized="true"
                         width="350">
            <a4j:loadScript src="/js/jquery.meio.mask.js"/>
            <f:facet name="header">
                <h:outputText value="#{bundle['_nls.perfil_padrao.item.add']}"/>
            </f:facet>
            <f:facet name="controls">
                <h:panelGroup>
                    <h:graphicImage value="/images/icons/close.gif"
                                    styleClass="hidelink" id="hidelinkAddRecurso"/>
                    <rich:componentControl for="addItemTabelaPrecoModal"
                                           attachTo="hidelinkAddRecurso" operation="hide" event="onclick"/>
                </h:panelGroup>
            </f:facet>


            <h:form styleClass="noMargin">
                <h:panelGrid columns="2">

                    <h:outputText
                            value="#{bundle['_nls.perfil_vendido.entity_name']}: "
                            styleClass="labelGeneric"/>
                    <a4j:region>
                        <rich:comboBox id="listaPerfilVendido"
                                       suggestionValues="#{msaController.itemTabelaPrecoBean.perfilVendidoList}"
                                       value="#{msaController.itemTabelaPrecoBean.to.perfilVendido.nomePerfilVendido}"
                                       label="#{bundle['_nls.item_tabela_preco.tabela_preco.label']}"
                                       valueChangeListener="#{msaController.trocaAtributos}"
                                       immediate="true" directInputSuggestions="true">
                            <a4j:support event="onselect" reRender="pmg, cidade, cargo"
                                         limitToList="true" immediate="true"/>
                            <a4j:support event="onchange" reRender="pmg, cidade, cargo"
                                         immediate="true" limitToList="true"/>
                        </rich:comboBox>
                    </a4j:region>

                    <h:outputText value="#{bundle['_nls.perfil_vendido.position']}: "
                                  styleClass="labelGeneric"/>
                    <h:outputText
                            value="#{msaController.itemTabelaPrecoBean.to.perfilVendido.perfilPadrao.cargoPms.nomeCargoPms}"
                            id="cargo"/>
                    <h:outputText value="#{bundle['_nls.perfil_vendido.PMG']}: "
                                  styleClass="labelGeneric"/>
                    <h:outputText
                            value="#{msaController.itemTabelaPrecoBean.to.perfilVendido.perfilPadrao.pmg.nomePmg}"
                            id="pmg"/>
                    <h:outputText value="#{bundle['_nls.perfil_vendido.base']}: "
                                  styleClass="labelGeneric"/>
                    <h:outputText
                            value="#{msaController.itemTabelaPrecoBean.to.perfilVendido.perfilPadrao.cidadeBase.siglaCidadeBase}"
                            id="cidade"/>

                    <h:outputText
                            value="#{bundle['_nls.item_tabela_preco.rate_type.label']}:"
                            for="rateType" styleClass="labelGeneric"/>
                    <h:selectOneRadio id="rateType"
                                      value="#{msaController.itemTabelaPrecoBean.isPricePerFTE}">
                        <f:selectItem
                                itemLabel="#{bundle['_nls.item_tabela_preco.rate_type.hrs.label']}"
                                itemValue="#{false}"/>
                        <f:selectItem
                                itemLabel="#{bundle['_nls.item_tabela_preco.rate_type.fte.label']}"
                                itemValue="#{true}"/>
                    </h:selectOneRadio>

                </h:panelGrid>

                <h:panelGrid columns="5">
                    <h:outputText
                            value="#{bundle['_nls.item_tabela_preco.valor_item_tb_preco.label']}:"
                            for="valorItem" styleClass="labelGeneric"/>

                    <h:inputText id="valorItem" size="15" maxlength="10"
                                 immediate="true"
                                 label="#{bundle['_nls.item_tabela_preco.valor_item_tb_preco.label']}"
                                 value="#{msaController.itemTabelaPrecoBean.to.valorItemTbPreco}">
                        <rich:jQuery selector="#valorItem"
                                     query="setMask('#{bundle['jquery.monetary.pattern']}')"
                                     timing="onload"/>
                        <f:convertNumber locale="#{bundle['locale.en_us']}"
                                         pattern="#{systemProperties['pattern.number']}"/>
                        <a4j:support event="onblur"
                                     action="#{msaController.apagaValoresNovoItem}" limitToList="true"
                                     reRender="vlrEmbedded,prcEmbedded"/>
                    </h:inputText>

                    <rich:spacer width="5px"/>
                    <a4j:region>
                        <h:selectBooleanCheckbox id="checkboxEmbedded"
                                                 value="#{msaController.itemTabelaPrecoBean.isExpenseEmbedded}">
                            <a4j:support event="onclick"
                                         action="#{msaController.displayFieldsItemTabPreco}"
                                         reRender="vlrEmbedded, prcEmbedded" limitToList="true"/>
                        </h:selectBooleanCheckbox>
                    </a4j:region>
                    <h:outputText
                            value="#{bundle['_nls.item_tabela_preco.expenses_embedded']}"/>
                </h:panelGrid>

                <h:panelGrid columns="5">
                    <h:outputText
                            value="#{bundle['_nls.item_tabela_preco.embedded_cost']}: "
                            styleClass="labelGeneric"/>
                    <h:inputText
                            value="#{msaController.itemTabelaPrecoBean.vlrEmbedded}" size="15"
                            id="vlrEmbedded"
                            disabled="#{!msaController.itemTabelaPrecoBean.isExpenseEmbedded}">
                        <a4j:support event="onblur"
                                     action="#{msaController.calculaPrcDespesaNovoItem}"
                                     limitToList="true" reRender="prcEmbedded"/>
                    </h:inputText>

                    <rich:spacer width="5px"/>

                    <h:inputText
                            value="#{msaController.itemTabelaPrecoBean.to.percentualDespesa}"
                            id="prcEmbedded"
                            disabled="#{!msaController.itemTabelaPrecoBean.isExpenseEmbedded}">
                        <a4j:support event="onblur"
                                     action="#{msaController.calculaVlrDespesaNovoItem}"
                                     limitToList="true" reRender="vlrEmbedded"/>
                    </h:inputText>

                    <h:outputText value="%"/>
                </h:panelGrid>

                <rich:spacer height="15px"/>

                <a4j:commandButton value="#{bundle['_nls.button.save']}"
                                   action="#{msaController.createItemTabelaPreco}"
                                   oncomplete="#{rich:component('addItemTabelaPrecoModal')}.hide();return false;"
                                   styleClass="buttonGeneric"/>

                <rich:spacer width="15px"/>

                <a4j:commandButton value="#{bundle['_nls.button.cancel']}"
                                   styleClass="buttonGeneric"
                                   oncomplete="#{rich:component('addItemTabelaPrecoModal')}.hide();return false;"/>

            </h:form>

        </rich:modalPanel>

        <!-- Modal do delete de item da tabela de item Preco -->
        <rich:modalPanel id="deleteItemTabelaPrecoPanel" autosized="true"
                         width="200">
            <f:facet name="header">
                <h:outputText value="#{bundle['_nls.title.confirmation']}"
                              style="padding-right:15px;"/>
            </f:facet>
            <f:facet name="controls">
                <h:panelGroup>
                    <h:graphicImage value="/images/icons/close.gif"
                                    styleClass="hidelink" id="hidelinkDeleteItemTabelaPreco"/>
                    <rich:componentControl for="deleteItemTabelaPrecoPanel"
                                           attachTo="hidelinkDeleteItemTabelaPreco" operation="hide"
                                           event="onclick"/>
                </h:panelGroup>
            </f:facet>
            <h:outputText
                    value="#{bundle['_nls.item_tabela_preco.delete.title']}"
                    style="padding-right:15px;"/>
            <h:form>
                <rich:spacer height="5"/>
                <table width="100%">
                    <tbody>
                    <tr>
                        <td align="center" width="50%"><a4j:commandButton
                                value="#{bundle['_nls.button.ok']}" ajaxSingle="true"
                                action="#{msaController.removeItemTabelaPreco}"
                                oncomplete="#{rich:component('deleteItemTabelaPrecoPanel')}.hide();"
                                styleClass="buttonGeneric"/></td>
                        <td align="center" width="50%"><a4j:commandButton
                                value="#{bundle['_nls.button.cancel']}"
                                styleClass="buttonGeneric"
                                oncomplete="#{rich:component('deleteItemTabelaPrecoPanel')}.hide();return false;"/>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </h:form>
        </rich:modalPanel>

        <!-- Modal para fazer upload de arquivo -->
        <rich:modalPanel id="addArquivoModal" autosized="true" width="500">
            <f:facet name="header">
                <h:outputText value="#{bundle['_nls.anexo.tabela_preco.attach']}"
                              style="padding-right:15px;"/>
            </f:facet>
            <f:facet name="controls">
                <h:panelGroup>
                    <h:graphicImage value="/images/icons/close.gif"
                                    styleClass="hidelink" id="hidelinkUpload"/>
                    <rich:componentControl for="addArquivoModal"
                                           attachTo="hidelinkUpload" operation="hide" event="onclick"/>
                </h:panelGroup>
            </f:facet>
            <h:form>
                <a4j:region renderRegionOnly="true">
                    <h:panelGrid columns="2" id="panel">
                        <h:outputText value="File: " styleClass="labelGeneric"/>

                        <rich:fileUpload maxFilesQuantity="1" listHeight="60px"
                                         listWidth="100%" id="fileUpload" noDuplicate="true"
                                         allowFlash="false" immediateUpload="false"
                                         fileUploadListener="#{msaController.uploadArquivoItemTabPreco}">

                            <f:facet name="label">
                                <h:outputText value="{_KB}KB from {KB}KB uploaded --- {mm}:{ss}"/>
                            </f:facet>

                            <a4j:support event="onuploadcomplete" limitToList="true"
                                         reRender="teste"/>

                        </rich:fileUpload>
                        <h:outputText value="Comment: " styleClass="labelGeneric"/>
                        <h:inputTextarea style="width:400px;"
                                         value="#{msaController.anexoTabelaPrecoBean.textoComentario}">
                            <a4j:support event="onblur" limitToList="true"/>
                        </h:inputTextarea>

                        <rich:spacer height="15"/>

                        <h:panelGrid columns="2" id="teste">
                            <a4j:commandButton value="#{bundle['_nls.button.cancel']}"
                                               styleClass="buttonGeneric"
                                               action="#{msaController.cancelItemTabelaPreco}"
                                               oncomplete="#{rich:component('addArquivoModal')}.hide();return false;"
                                               style="align: center;"/>
                            <h:commandButton action="#{msaController.saveAnexo}"
                                             rendered="#{msaController.anexoTabelaPrecoBean.flagButtonSaveUpload}"
                                             value="Save Import" id="btnSaveImport"/>
                        </h:panelGrid>

                    </h:panelGrid>
                </a4j:region>
            </h:form>
        </rich:modalPanel>

        <!-- Modal do delete do anexo -->
        <rich:modalPanel id="deleteAnexoModalPanel" autosized="true"
                         width="200">
            <f:facet name="header">
                <h:outputText value="#{bundle['_nls.title.confirmation']}"
                              style="padding-right:15px;"/>
            </f:facet>
            <f:facet name="controls">
                <h:panelGroup>
                    <h:graphicImage value="/images/icons/close.gif"
                                    styleClass="hidelink" id="hidelinkDeleteAnexo"/>
                    <rich:componentControl for="deleteAnexoModalPanel"
                                           attachTo="hidelinkDeleteAnexo" operation="hide" event="onclick"/>
                </h:panelGroup>
            </f:facet>
            <h:outputText value="#{bundle['_nls.anexo.delete']}"
                          style="padding-right:15px;"/>


            <h:form>
                <rich:spacer height="5"/>
                <table width="100%">
                    <tbody>
                    <tr>
                        <td align="center" width="50%"><a4j:commandButton
                                value="#{bundle['_nls.button.ok']}" ajaxSingle="true"
                                action="#{msaController.removeAnexoTabelaPreco}"
                                oncomplete="#{rich:component('deleteAnexoModalPanel')}.hide();"
                                styleClass="buttonGeneric" reRender="listaAnexo"/></td>
                        <td align="center" width="50%"><a4j:commandButton
                                value="#{bundle['_nls.button.cancel']}"
                                styleClass="buttonGeneric"
                                oncomplete="#{rich:component('deleteAnexoModalPanel')}.hide();return false;"/>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </h:form>
        </rich:modalPanel>


        <!-- Modal das razões para desaprovar a Price Table -->
        <rich:modalPanel id="notApproveReasonsPanel" autosized="true" width="200" showWhenRendered="#{msaController.bean.priceTableStatusSelectName == 'Not Approved'}">
            <f:facet name="header">
                <h:outputText value="#{bundle['_nls.tabela_preco.reasons_to_disapprove.title']}"
                              style="padding-right:15px;" />
            </f:facet>
            <f:facet name="controls">
                <h:panelGroup>
                    <h:graphicImage value="/images/icons/close.gif" styleClass="hidelink"
                                    id="hidelink" />
                    <rich:componentControl for="notApproveReasonsPanel"
                                           attachTo="hidelink" operation="hide" event="onclick" />
                </h:panelGroup>
            </f:facet>
            <h:form>
                <table width="100%">
                    <tbody>
                    <tr>
                        <td colspan="2"><h:inputTextarea
                                value="#{msaController.bean.notApproveReasonsDescription}" cols="50" rows="10" />
                        </td>
                    </tr>
                    <tr>
                        <td align="center" width="50%"><a4j:commandButton
                                value="#{bundle['_nls.button.ok']}"
                                action="#{msaController.updateListItem}"
                                oncomplete="#{rich:component('notApproveReasonsPanel')}.hide();"
                                styleClass="buttonGeneric" />
                        </td>
                    </tr>
                    </tbody>
                </table>
            </h:form>
        </rich:modalPanel>

    </ui:define>
</ui:composition>

</html>
