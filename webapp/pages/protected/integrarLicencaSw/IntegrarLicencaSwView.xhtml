<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:a4j="http://richfaces.org/a4j">

<ui:composition template="/WEB-INF/templates/formLayout.xhtml">

    <ui:define name="titleForm">#{bundle['_nls.menu.chargeback.software']} &gt; #{bundle['_nls.menu.chargeback.software.view']}</ui:define>

    <ui:define name="bodyForm">
        <rich:spacer height="0" width="560" styleClass="noMargin" />
        <h:form styleClass="noMargin">
            <a4j:loadScript src="/js/utils.js" />
            <a4j:loadScript src="/js/jquery.numeric.js" />
            <a4j:loadScript src="/js/jquery.meio.mask.js" />
            <a4j:keepAlive beanName="integrarLicencaSoftwareBean" />

            <h:panelGrid columns="2">

                <h:outputLabel value="#{bundle['_nls.chargeback.data_mes.label']}:"
                               styleClass="labelRigthAlign"
                               rendered="#{integrarLicencaSoftwareController.bean.toProject != null}" />
                <h:outputText value="#{integrarLicencaSoftwareController.bean.toProject.dataParcela}"
                              rendered="#{integrarLicencaSoftwareController.bean.toProject != null}">
                    <f:convertDateTime pattern="#{bundle['_nls.date.pattern.simple']}" locale="#{bundle['locale.en_us']}" />
                </h:outputText>

                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <h:outputLabel value="#{bundle['_nls.chargeback.resource_type.label']}:"
                               styleClass="labelRigthAlign"
                               rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <h:outputText value="#{integrarLicencaSoftwareController.bean.tipoRecurso}"
                              converter="TipoTiRecursoConverter"
                              rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <h:outputLabel value="#{bundle['_nls.chargeback.invoice_number.label']}: "
                               styleClass="labelRigthAlign"
                               rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <h:outputText value="#{integrarLicencaSoftwareController.bean.toProject.notaFiscal}"
                              rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <h:outputLabel id="contractLobListLabel" value="#{bundle['_nls.chargeback.project.label']}: "
                               styleClass="labelRigthAlign"
                               rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <h:outputText value="#{integrarLicencaSoftwareController.bean.toProject.nomeProjeto}"
                              rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <h:outputLabel value="#{bundle['_nls.chargeback.resource_name.label']}: "
                               styleClass="labelRigthAlign"
                               rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <h:outputText value="#{integrarLicencaSoftwareController.bean.toProject.nomeLicenca}"
                              rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <h:outputLabel value="#{bundle['_nls.chargeback.branch.label']}: "
                               styleClass="labelRigthAlign"
                               rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <h:outputText value="#{integrarLicencaSoftwareController.bean.toProject.empresa.nomeEmpresa}"
                              rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <h:outputLabel value="#{bundle['_nls.chargeback.installments_amount.label']}:"
                               styleClass="labelRigthAlign"
                               rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <h:outputText value="#{integrarLicencaSoftwareController.bean.toProject.qtdeParcelas}"
                              rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <h:outputLabel value="#{bundle['_nls.chargeback.installments_number.label']}:"
                               styleClass="labelRigthAlign"
                               rendered="#{integrarLicencaSoftwareController.bean.toProject != null}" />
                <h:outputText value="#{integrarLicencaSoftwareController.bean.toProject.parcelaApropriada}"
                              rendered="#{integrarLicencaSoftwareController.bean.toProject != null}" />

                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <h:outputLabel value="#{bundle['_nls.chargeback.provider.label']}: "
                               styleClass="labelRigthAlign"
                               rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <h:outputText value="#{integrarLicencaSoftwareController.bean.toProject.nomeFornecedor}"
                              rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <h:outputLabel value="#{bundle['_nls.chargeback.ti_recurso.label']}:"
                               styleClass="labelRigthAlign" />
                <h:outputLabel value="#{integrarLicencaSoftwareController.bean.toProject == null ? integrarLicencaSoftwareController.bean.toUser.nomeLicenca : integrarLicencaSoftwareController.bean.toProject.nomeLicenca}" />

                <rich:spacer height="5" styleClass="noMargin" />
                <rich:spacer height="5" styleClass="noMargin" />

                <h:outputLabel value="#{bundle['_nls.chargeback.total_amount.label']}: " styleClass="labelRigthAlign" />
                <h:outputText value="#{integrarLicencaSoftwareController.bean.toProject == null ? integrarLicencaSoftwareController.bean.toUser.valorTotal : integrarLicencaSoftwareController.bean.toProject.valorTotal}">
                    <f:convertNumber type="currency"  />
                </h:outputText>

                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <h:outputText value="#{bundle['_nls.deal.moeda.label']}: "
                              styleClass="labelRigthAlign"
                              rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <h:outputText value="#{integrarLicencaSoftwareController.bean.toProject.moeda.nomeMoeda}"
                              rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <rich:spacer rendered="#{integrarLicencaSoftwareController.bean.toProject != null}">
                    <h:outputText value="#{bundle['_nls.chargeback.installments_amount.label']}"
                                  escape="false"
                                  styleClass="labelRigthAlign"/>
                    <br/>
                    <h:outputLabel value="(value): "
                                   styleClass="labelRigthAlign"/>
                </rich:spacer>
                <h:outputLabel value="#{integrarLicencaSoftwareController.bean.toProject.valorParcial}"
                               rendered="#{integrarLicencaSoftwareController.bean.toProject != null}" >
                    <f:convertNumber type="currency" />
                </h:outputLabel>

                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <h:outputLabel value="#{bundle['_nls.chargeback.start_date.label']}: "
                               styleClass="labelRigthAlign"
                               rendered="#{integrarLicencaSoftwareController.bean.toProject != null}" />
                <h:outputText value="#{integrarLicencaSoftwareController.bean.toProject.dataInicio}"
                              rendered="#{integrarLicencaSoftwareController.bean.toProject != null}">
                    <f:convertDateTime pattern="#{bundle['_nls.date.pattern.simple']}"
                                       locale="#{bundle['locale.en_us']}" />
                </h:outputText>

                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>
                <rich:spacer height="5" styleClass="noMargin" rendered="#{integrarLicencaSoftwareController.bean.toProject != null}"/>

                <h:outputLabel value="#{bundle['_nls.chargeback.login.label']}: "
                               styleClass="labelRigthAlign"
                               rendered="#{integrarLicencaSoftwareController.bean.toProject != null}" />
                <h:outputText value="#{integrarLicencaSoftwareController.bean.toProject.logins}"
                              rendered="#{integrarLicencaSoftwareController.bean.toProject != null}">
                    <f:convertDateTime pattern="#{bundle['_nls.date.pattern.simple']}"
                                       locale="#{bundle['locale.en_us']}" />
                </h:outputText>

                <rich:spacer height="5" styleClass="noMargin" />
                <rich:spacer height="5" styleClass="noMargin" />

                <h:outputLabel value="#{bundle['_nls.ti_recurso.indicador_ativo.label']}:"
                               styleClass="labelRigthAlign"  />
                <h:outputLabel converter="IntegrateConverter"
                               value="#{integrarLicencaSoftwareController.bean.toProject == null ? integrarLicencaSoftwareController.bean.toUser.status : integrarLicencaSoftwareController.bean.toProject.status}" />

                <rich:spacer height="5" styleClass="noMargin" />
                <rich:spacer height="5" styleClass="noMargin" />

            </h:panelGrid>

            <h:panelGrid columns="2">
                <f:facet name="footer">
                <h:panelGrid columns="3" cellpadding="0" cellspacing="0">
                    <a4j:commandButton value="#{bundle['_nls.button.back']}"
                                       styleClass="buttonGeneric"
                                       action="#{integrarLicencaSoftwareController.backIntegrate}"
                                       rendered="#{integrarLicencaSoftwareController.bean.telaIntegrate}"/>
                    <a4j:commandButton value="#{bundle['_nls.button.back']}"
                                       styleClass="buttonGeneric"
                                       action="#{integrarLicencaSoftwareController.backSearch}"
                                       rendered="#{!integrarLicencaSoftwareController.bean.telaIntegrate}"/>
                    <rich:spacer height="5" width="5" />
                </h:panelGrid>
                </f:facet>
            </h:panelGrid>

            <!-- Grid Licencas por Login -->
            <rich:spacer height="5" styleClass="noMargin" />
            <rich:spacer height="5" styleClass="noMargin" />

            <!-- Grid Licencas por Projeto -->
            <rich:spacer height="5" styleClass="noMargin" />
            <a4j:outputPanel id="resultPanelProject">
                <rich:dataTable value="#{integrarLicencaSoftwareController.bean.licencaSwProjetoRowDetailList}"
                                rendered="#{!empty integrarLicencaSoftwareController.bean.licencaSwProjetoRowDetailList}"
                                var="itemProjectDetail"
                                width="100%"
                                id="licenseProjectDetailTable">

                    <rich:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.ti_recurso_integracao.centro_custo.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemProjectDetail.nomeGrupoCusto}" />
                    </rich:column>

                    <rich:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.ti_recurso_integracao.projeto.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemProjectDetail.nomeProjeto == null ? itemProjectDetail.nomeProjetoErp : itemProjectDetail.nomeProjeto}" />
                    </rich:column>

                    <rich:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.chargeback.license_ID.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemProjectDetail.idLicenca}" />
                    </rich:column>

                    <rich:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.chargeback.installments_number.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemProjectDetail.numeroParcela}" />
                    </rich:column>

                    <rich:column style="text-align: center;">

                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.chargeback.data_mes.label']}" />
                        </f:facet>

                        <h:outputText value="#{itemProjectDetail.dataParcela}">
                            <f:convertDateTime pattern="#{bundle['_nls.date.pattern.simple']}"
                                               locale="#{bundle['locale.en_us']}" />
                        </h:outputText>

                    </rich:column>


                    <rich:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.ti_recurso_integracao.valorApropriacao.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemProjectDetail.valor}">
                            <f:convertNumber type="currency" />
                        </h:outputText>
                    </rich:column>

                </rich:dataTable>

                <rich:spacer height="5" styleClass="noMargin" />
                <h:panelGrid columns="1"
                             style="background-color: #C0C0C0; width: 100%;"
                             rendered="#{!empty integrarLicencaSoftwareController.bean.previousLicencaSwProjetoRowDetailList}">
                    <h:outputText value="#{bundle['_nls.ti_recurso_integracao.view.previous']}"
                                  style="font-weight:bold; border-radius: 10px" />
                </h:panelGrid>

                <rich:dataTable value="#{integrarLicencaSoftwareController.bean.previousLicencaSwProjetoRowDetailList}"
                                rendered="#{!empty integrarLicencaSoftwareController.bean.previousLicencaSwProjetoRowDetailList}"
                                var="itemProjectDetail"
                                width="100%"
                                id="licenseProjectDetailTable2">

                    <rich:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.ti_recurso_integracao.centro_custo.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemProjectDetail.nomeGrupoCusto}" />
                    </rich:column>

                    <rich:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.ti_recurso_integracao.projeto.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemProjectDetail.nomeProjeto == null ? itemProjectDetail.nomeProjetoErp : itemProjectDetail.nomeProjeto}" />
                    </rich:column>

                    <rich:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.chargeback.license_ID.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemProjectDetail.idLicenca}" />
                    </rich:column>

                    <rich:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.chargeback.installments_number.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemProjectDetail.numeroParcela}" />
                    </rich:column>

                    <rich:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.chargeback.data_mes.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemProjectDetail.dataParcela}">
                            <f:convertDateTime pattern="#{bundle['_nls.date.pattern.simple']}"
                                               locale="#{bundle['locale.en_us']}" />
                        </h:outputText>
                    </rich:column>

                    <rich:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.ti_recurso_integracao.valorApropriacao.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemProjectDetail.valor}">
                            <f:convertNumber type="currency" />
                        </h:outputText>
                    </rich:column>

                </rich:dataTable>

                <h:panelGrid columns="2"
                             style="display: flex;padding-right: 3vh; justify-content: flex-end; background-color: #ECF4FE; border-bottom: solid 1px #C0C0C0; border-left: solid 1px #C0C0C0; border-right: solid 1px #C0C0C0;"
                             rendered="#{!empty integrarLicencaSoftwareController.bean.previousLicencaSwProjetoRowDetailList}">
                    <h:outputText value="#{bundle['_nls.chargeback.paid_amount.label']}:"
                                  style="font-weight:bold; padding-right: 3vh;" />

                    <h:outputText value="#{integrarLicencaSoftwareController.bean.valorParcial}"
                                  style="font-weight:bold">
                        <f:convertNumber type="currency" />
                    </h:outputText>
                </h:panelGrid>
            </a4j:outputPanel>

            <!-- Grid Licencas por usuario -->
            <rich:spacer height="5" styleClass="noMargin" />
            <a4j:outputPanel id="resultPanelUser"
                             rendered="#{!empty integrarLicencaSoftwareController.bean.licencaSwUserRowListDetail}">
                <rich:dataTable value="#{integrarLicencaSoftwareController.bean.licencaSwUserRowListDetail}"
                                rendered="#{!integrarLicencaSoftwareController.bean.hasIncIntegration}"
                                var="itemUserDetail"
                                width="100%"
                                id="licenseUserDetailTable">

                    <ui:include src="/pages/protected/integrarLicencaSw/IntegrarLicencaSwViewColumns.xhtml">
                        <ui:param name="itemUserDetail" value="#{itemUserDetail}" />
                    </ui:include>

                </rich:dataTable>

                <rich:dataTable value="#{integrarLicencaSoftwareController.bean.licencaSwUserRowListDetail}"
                                rendered="#{integrarLicencaSoftwareController.bean.hasIncIntegration}"
                                var="itemUserDetail"
                                width="100%"
                                id="licenseUserDetailTableInc">

                    <ui:include src="/pages/protected/integrarLicencaSw/IntegrarLicencaSwViewColumns.xhtml">
                        <ui:param name="itemUserDetail" value="#{itemUserDetail}" />
                    </ui:include>

                    <rich:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.chargeback.document_number.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemUserDetail.integrate.docNumber}" />
                    </rich:column>

                    <rich:column style="text-align: center;">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.chargeback.integration_id.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemUserDetail.integrate.integrationId}" />
                    </rich:column>

                    <rich:column style="text-align: center;" id="statusColumn">
                        <f:facet name="header">
                            <h:outputText value="#{bundle['_nls.chargeback.status.label']}" />
                        </f:facet>
                        <h:outputText value="#{itemUserDetail.integrate.status}" />
                        <rich:toolTip for="statusColumn"
                                      value="#{itemUserDetail.integrate.message}"
                                      rendered="#{not empty itemUserDetail.integrate.message}" />
                    </rich:column>

                </rich:dataTable>
            </a4j:outputPanel>

        </h:form>
    </ui:define>

</ui:composition>
</html>